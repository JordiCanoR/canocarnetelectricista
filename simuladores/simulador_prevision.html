<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<title>Simulador Previsión de Cargas</title>
<style>
    body { font-family: Arial, sans-serif; padding: 20px; line-height: 1.6; }
    h1, h2 { background-color: #e0e0e0; padding: 10px; }
    input[type='text'], input[type='number'] { width: 300px; margin: 4px; padding: 4px; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
    th, td { border: 1px solid #333; padding: 6px; text-align: center; }
    .section { margin-top: 30px; }
</style>
</head>
<body>
<h1>PLANTILLA DE CÁLCULO DE CARGAS ELÉCTRICAS - REBT (Guía BT-10)</h1>
<div class="section">
<h2>1. DATOS GENERALES DEL PROYECTO</h2>
<label>Nombre del proyecto: <input type="text"/></label><br/>
<label>Ubicación: <input type="text"/></label><br/>
<label>Tipo de edificio: <input type="text"/></label><br/>
<label>Instalador/Proyectista: <input type="text"/></label><br/>
<label>Fecha: <input type="text"/></label>
</div>

<div class="section">
<h2>2. VIVIENDAS: CÁLCULO DE POTENCIA PREVISTA</h2>
<table id="tablaViviendas">
<tr><th>Nº Vivienda</th><th>Superficie (m²)</th><th>Grado electrificación</th><th>Potencia prevista (W)</th></tr>
<tr><td><input type="text"/></td><td><input type="number"/></td><td><input type="text"/></td><td><input type="number"/></td></tr>
<tr><td><input type="text"/></td><td><input type="number"/></td><td><input type="text"/></td><td><input type="number"/></td></tr>
</table>
<button onclick="agregarFila('tablaViviendas')">Añadir vivienda</button>
<label>Media aritmética de potencias previstas: <input type="text"/> W</label><br/>
<label>Nº total de viviendas: <input type="number"/></label><br/>
<label>Coef. de simultaneidad (según tabla guía BT-10): <input step="any" type="number"/></label><br/>
<label>Potencia total viviendas: <input type="text"/> W</label>
</div>

<div class="section">
<h2>4. LOCALES COMERCIALES</h2>
<table id="tablaLocales">
<tr><th>Local</th><th>Superficie (m²)</th><th>W/m²</th><th>Potencia total (W)</th></tr>
<tr><td><input type="text"/></td><td><input type="number"/></td><td><input type="number"/></td><td><input type="number"/></td></tr>
<tr><td><input type="text"/></td><td><input type="number"/></td><td><input type="number"/></td><td><input type="number"/></td></tr>
</table>
<button onclick="agregarFila('tablaLocales')">Añadir local comercial</button>
<label>Total locales comerciales: <input id="totalLocales" type="text"/> W</label>
</div>

<div class="section">
<h2>5. OFICINAS</h2>
<table id="tablaOficinas">
<tr><th>Oficina</th><th>Superficie (m²)</th><th>W/m²</th><th>Potencia total (W)</th></tr>
<tr><td><input type="text"/></td><td><input type="number"/></td><td><input type="number"/></td><td><input type="number"/></td></tr>
<tr><td><input type="text"/></td><td><input type="number"/></td><td><input type="number"/></td><td><input type="number"/></td></tr>
</table>
<button onclick="agregarFila('tablaOficinas')">Añadir oficina</button>
<label>Total oficinas: <input id="totalOficinas" type="text"/> W</label>
</div>

<script>
function agregarFila(idTabla) {
    const tabla = document.getElementById(idTabla);
    if (!tabla) return;
    const fila = tabla.insertRow(-1);
    const columnas = tabla.rows[0].cells.length;
    for (let i = 0; i < columnas; i++) {
        const celda = fila.insertCell(i);
        const input = document.createElement("input");
        input.type = i === 0 ? "text" : "number";
        input.placeholder = "";
        input.oninput = calcularTotales;
        celda.appendChild(input);
    }
    calcularTotales();
}

function calcularTotales() {
    calcularSeccion('tablaLocales', 'totalLocales');
    calcularSeccion('tablaOficinas', 'totalOficinas');
}

function calcularSeccion(tablaId, salidaId) {
    const tabla = document.getElementById(tablaId);
    const salida = document.getElementById(salidaId);
    if (!tabla || !salida) return;
    let total = 0;
    for (let i = 1; i < tabla.rows.length; i++) {
        const cells = tabla.rows[i].cells;
        const superficie = parseFloat(cells[1].querySelector("input")?.value || 0);
        const wpm = parseFloat(cells[2].querySelector("input")?.value || 0);
        total += superficie * wpm;
        cells[3].querySelector("input").value = (superficie * wpm).toFixed(2);
    }
    salida.value = total.toFixed(2);
}
</script>
</body>
</html>