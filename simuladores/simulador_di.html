
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Simulación Derivación Individual</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        input[type=text], input[type=number] {
            width: 150px;
            padding: 5px;
            margin: 4px;
        }
        label {
            display: inline-block;
            width: 350px;
        }
        .form-section {
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #004080;
        }
    </style>
</head>
<body>
    <header>
        <h1>Simulador Derivación Individual</h1>
        <nav>
            <ul>
                <li><a href="../index.html">Inicio</a></li>
                <li><a href="simulador_lga.html">Simulación LGA</a></li>
                <li><a href="simulador_di.html">Simulación Derivación Individual</a></li>
                <li><a href="simulador_prevision.html">Simulación Previsión Cargas</a></li>
                <li><a href="../test/index.html">Test</a></li>
                <li><a href="../plantillas/index.html">Plantillas</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <h2>Formulario DI - Cálculos automáticos</h2>
        <form id="formDI">
            <div class="form-section">
                <h3>1. Datos Iniciales</h3>
                <label>Potencia prevista (kW):</label><input type="number" step="any" id="potencia"><br>
                <label>Tensión (V):</label><input type="number" step="any" id="tension"><br>
                <label>cos(phi):</label><input type="number" step="any" id="cosphi"><br>
                <label>Longitud derivación (m):</label><input type="number" step="any" id="longitud"><br>
                <label>¿Trifásica? (sí=1 / no=0):</label><input type="number" min="0" max="1" id="trifasica"><br>
                <label>¿Totalmente centralizado? (sí=1 / no=0):</label><input type="number" min="0" max="1" id="centralizado"><br>
            </div>

            <div class="form-section">
                <h3>2. Resultados</h3>
                <label>Caída máxima permitida (V):</label><input type="text" id="caida" readonly><br>
                <label>Intensidad (A):</label><input type="text" id="intensidad" readonly><br>
                <label>Sección (mm²):</label><input type="text" id="seccion" readonly><br>
            </div>

            <button type="button" onclick="calcular()">Calcular</button>
        </form>

        <script>
            function calcular() {
                const P = parseFloat(document.getElementById('potencia').value) * 1000;
                const U = parseFloat(document.getElementById('tension').value);
                const cosphi = parseFloat(document.getElementById('cosphi').value);
                const L = parseFloat(document.getElementById('longitud').value);
                const trifasica = parseInt(document.getElementById('trifasica').value);
                const centralizado = parseInt(document.getElementById('centralizado').value);

                if (isNaN(P) || isNaN(U) || isNaN(cosphi) || isNaN(L)) return;

                let e_pct = centralizado === 1 ? 1.0 : 0.5;
                let e = (e_pct / 100) * U;
                let I = trifasica === 1 ? P / (1.73 * U * cosphi) : P / (U * cosphi);
                let gamma = 56; // Suponemos cobre
                let S = trifasica === 1 ? (L * P) / (gamma * e * U) : (2 * L * P) / (gamma * e * U);

                document.getElementById('caida').value = e.toFixed(2);
                document.getElementById('intensidad').value = I.toFixed(2);
                document.getElementById('seccion').value = S.toFixed(2);
            }
        </script>
    </main>
</body>
</html>
