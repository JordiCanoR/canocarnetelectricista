<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simulador Derivación Individual - Pro</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #1e1e2f;
      color: #f0f0f0;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #4fc3f7;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: #2a2a40;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.5);
    }
    label {
      display: block;
      margin-top: 12px;
      font-weight: bold;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #555;
      border-radius: 5px;
      background-color: #1e1e2f;
      color: #f0f0f0;
    }
    button {
      margin-top: 20px;
      padding: 12px 25px;
      border: none;
      background-color: #4fc3f7;
      color: #1e1e2f;
      cursor: pointer;
      border-radius: 5px;
      font-size: 16px;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #0288d1;
    }
    .results {
      margin-top: 25px;
      padding: 15px;
      background: #35354f;
      border-radius: 8px;
      box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
    }
  </style>
</head>
<body>
<div class="container">
  <h1>Simulador Derivación Individual - Pro</h1>
  <label>Potencia prevista (kW)</label>
  <input type="number" id="potencia">

  <label>Tensión de suministro (V)</label>
  <input type="number" id="tension">

  <label>Tipo de suministro</label>
  <select id="tipo_suministro">
    <option value="mono">Monofásico</option>
    <option value="tri">Trifásico</option>
  </select>

  <label>Longitud de la derivación (m)</label>
  <input type="number" id="longitud">

  <label>Tipo de instalación</label>
  <select id="tipo_instalacion">
    <option value="A1">A1</option>
    <option value="A2">A2</option>
    <option value="B1">B1</option>
    <option value="B2">B2</option>
    <option value="D1">D1</option>
    <option value="D2">D2</option>
  </select>

  <label>Temperatura ambiente prevista (°C)</label>
  <input type="number" id="temperatura">

  <label>Caída de tensión máxima permitida (%)</label>
  <input type="number" step="0.1" id="caida">

  <label>Sección seleccionada (mm²)</label>
  <input type="number" id="seccion">

  <label>Tipo de cable</label>
  <input type="text" id="cable">

  <button onclick="calcular()">Calcular</button>
  <button onclick="reiniciar()">Reiniciar</button>

  <div class="results" id="resultados"></div>
</div>
<script>
const tablaIntensidades = {
  "A1": {1.5: 14, 2.5: 20, 4: 25, 6: 32, 10: 45, 16: 60, 25: 80, 35: 100, 50: 125, 70: 160, 95: 200, 120: 230, 150: 260, 185: 300, 240: 340},
  "A2": {1.5: 17, 2.5: 25, 4: 32, 6: 40, 10: 55, 16: 75, 25: 100, 35: 125, 50: 150, 70: 195, 95: 230, 120: 265, 150: 300, 185: 340, 240: 400},
  "B1": {1.5: 17, 2.5: 25, 4: 32, 6: 40, 10: 55, 16: 75, 25: 100, 35: 125, 50: 150, 70: 195, 95: 230, 120: 265, 150: 300, 185: 340, 240: 400},
  "B2": {1.5: 19, 2.5: 27, 4: 36, 6: 46, 10: 63, 16: 85, 25: 115, 35: 135, 50: 165, 70: 215, 95: 260, 120: 300, 150: 340, 185: 385, 240: 450},
  "D1": {1.5: 20.5, 2.5: 27.5, 4: 36, 6: 44, 10: 59, 16: 78, 25: 104, 35: 129, 50: 158, 70: 199, 95: 240, 120: 276, 150: 309, 185: 342, 240: 380},
  "D2": {1.5: 24.5, 2.5: 32.5, 4: 42, 6: 51, 10: 68, 16: 91, 25: 123, 35: 152, 50: 186, 70: 233, 95: 282, 120: 324, 150: 362, 185: 400, 240: 450}
};
function calcular() {
  const P = parseFloat(document.getElementById('potencia').value) * 1000;
  const U = parseFloat(document.getElementById('tension').value);
  const tipo = document.getElementById('tipo_suministro').value;
  const L = parseFloat(document.getElementById('longitud').value);
  const tipoInstal = document.getElementById('tipo_instalacion').value;
  const caida = parseFloat(document.getElementById('caida').value) / 100 * U;
  const seccion = parseFloat(document.getElementById('seccion').value);
  let cosphi = 0.95;
  let I = (tipo === 'mono') ? (P / (U * cosphi)) : (P / (1.73 * U * cosphi));
  let gamma = 56;
  let Scalc = (tipo === 'mono') ? ((2 * L * P) / (gamma * caida * U)) : ((L * P) / (gamma * caida * U));
  let Iadm = tablaIntensidades[tipoInstal][seccion] || 'No disponible';
  let resultado = `<strong>Resultado:</strong><br>`;
  resultado += `Intensidad calculada: ${I.toFixed(2)} A<br>`;
  resultado += `Sección mínima calculada: ${Scalc.toFixed(2)} mm²<br>`;
  resultado += `Sección seleccionada: ${seccion} mm²<br>`;
  resultado += `Intensidad admisible para ${tipoInstal} según tabla: ${Iadm} A<br>`;
  resultado += (typeof Iadm === 'number' && I <= Iadm) ? `<span style='color:lime;'>La sección cumple normativa.</span>` : `<span style='color:red;'>La sección NO cumple normativa.</span>`;
  document.getElementById('resultados').innerHTML = resultado;
}
function reiniciar() {
  document.querySelectorAll('input').forEach(input => input.value = '');
  document.getElementById('tipo_suministro').selectedIndex = 0;
  document.getElementById('tipo_instalacion').selectedIndex = 0;
  document.getElementById('resultados').innerHTML = '';
}
</script>
</body>
</html>
