<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador LGA Mejorado</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        /* ===== ESTILO MEJORADO PARA SIMULADOR LGA ===== */

        .sim-card {
            background: #ffffffee;
            border: 2px solid #007bff;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 20px;
            margin: 20px auto;
            max-width: 600px;
        }

        .sim-card h2 {
            text-align: center;
            color: #007bff;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .sim-table {
            width: 100%;
            border-collapse: collapse;
        }

        .sim-table th, .sim-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
        }

        .sim-table th {
            background-color: #007bff;
            color: white;
            font-weight: bold;
        }

        .sim-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        #formLGA button {
            display: block;
            margin: 20px auto;
            padding: 12px 25px;
            font-size: 16px;
            background-color: #28a745;
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        #formLGA button:hover {
            background-color: #218838;
        }

        @media (max-width: 600px) {
            .sim-card {
                padding: 15px;
                margin: 10px;
            }

            .sim-table th, .sim-table td {
                padding: 8px;
            }

            #formLGA button {
                width: 100%;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <h1 style="text-align:center; color:#007bff;">Simulador LGA - Mejorado</h1>
    <form id="formLGA">
        <div class="sim-card">
            <h2>Datos de Entrada</h2>
            <label>Potencia prevista (W): <input type="number" id="potencia" value="148890"></label><br>
            <label>Tensión (V): <input type="number" id="tension" value="400"></label><br>
            <label>cos(phi): <input type="number" step="any" id="cosphi" value="0.9"></label><br>
            <label>Longitud LGA (m): <input type="number" id="longitud" value="23"></label><br>
            <label>Conductividad (γ, m/Ohm·mm²): <input type="number" step="any" id="gamma" value="44"></label><br>
            <label>¿Trifásica? (1 = sí, 0 = no): <input type="number" id="trifasica" value="1"></label><br>
            <label>¿Centralización parcial? (1 = sí, 0 = no): <input type="number" id="centralizado" value="1"></label><br>
        </div>

        <div class="sim-card">
            <h2>Resultados</h2>
            <table class="sim-table">
                <tr><th>Concepto</th><th>Valor</th></tr>
                <tr><td>Caída máxima permitida (V)</td><td id="caida"></td></tr>
                <tr><td>Intensidad (A)</td><td id="intensidad"></td></tr>
                <tr><td>Sección (mm²)</td><td id="seccion"></td></tr>
                <tr><td>Sección conductor neutro</td><td id="neutro"></td></tr>
                <tr><td>Diámetro tubo</td><td id="tubo"></td></tr>
                <tr><td>Fusible recomendado CGP</td><td id="fusible"></td></tr>
                <tr><td>Conductores a usar</td><td id="conductores"></td></tr>
                <tr><td>Sección comercial elegida</td><td id="seccionComercial"></td></tr>
                <tr><td>Intensidad máxima permitida</td><td id="intensidadMax"></td></tr>
            </table>
        </div>
        <button type="button" onclick="calcular()">Calcular</button>
    </form>

    <script>
        function calcular() {
            const P = parseFloat(document.getElementById('potencia').value);
            const U = parseFloat(document.getElementById('tension').value);
            const cosphi = parseFloat(document.getElementById('cosphi').value);
            const L = parseFloat(document.getElementById('longitud').value);
            const gamma = parseFloat(document.getElementById('gamma').value);
            const trifasica = parseInt(document.getElementById('trifasica').value);
            const centralizado = parseInt(document.getElementById('centralizado').value);

            let e_pct = centralizado === 1 ? 1 : 0.5;
            let e = (e_pct / 100) * U;
            let I = trifasica === 1 ? P / (1.73 * U * cosphi) : P / (U * cosphi);
            let S = trifasica === 1 ? (L * P) / (gamma * e * U) : (2 * L * P) / (gamma * e * U);

            let seccionComercial = S <= 25 ? 25 : (S <= 35 ? 35 : (S <= 50 ? 50 : (S <= 70 ? 70 : 95)));
            let intensidades = { 25: 116, 35: 136, 50: 152, 70: 192, 95: 232 };
            let intensidadMax = intensidades[seccionComercial];

            let fusible = Math.ceil(I / 10) * 10;
            let diametroTubo = seccionComercial <= 35 ? "40 mm" : "50 mm";

            document.getElementById('caida').innerText = e.toFixed(2);
            document.getElementById('intensidad').innerText = I.toFixed(2);
            document.getElementById('seccion').innerText = S.toFixed(0) + " mm²";
            document.getElementById('neutro').innerText = Math.floor(seccionComercial * 0.7) + " mm²";
            document.getElementById('tubo').innerText = diametroTubo;
            document.getElementById('fusible').innerText = fusible + " A";
            document.getElementById('conductores').innerText = "3 fases + 1 neutro";
            document.getElementById('seccionComercial').innerText = seccionComercial + " mm²";
            document.getElementById('intensidadMax').innerText = intensidadMax + " A";
        }
    </script>
</body>
</html>
